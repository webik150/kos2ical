function whenAvailable(t,e){window.setTimeout(function(){window[t]?e(window[t]):whenAvailable(t,e)},10)}function dayFromPosition(t){let e=t.offsetTop/120;return 0===e?"MO":1===e?"TU":2===e?"WE":3===e?"TH":4===e?"FR":void 0}function generateICal(){var t=new ICAL.Component(["vcalendar",[],[]]);t.updatePropertyWithValue("prodid","-//AMU KOS Schedule generator");let e=$("#tabRozvrh [id^=detaillistek"),n=$("#tabRozvrh [id^=listek");for(let a=0;a<e.length;a++){let r=$(e.get(a)).children().contents().filter(function(){return 1==this.nodeType}),i=$(e.get(a)).children().contents().filter(function(){return 3==this.nodeType}).map(function(t,e){return e.nodeValue.replace(/[:\-,\(\)]|[0-9]/g,"").trim()});texty=[];for(let t=0;t<i.length;t++)i[t]&&texty.push({title:i[t],value:""});let o=0;for(let t=0;t<r.length&&o<texty.length;t++)"BR"==r[t].tagName?o++:""==texty[o].value?texty[o].value=r[t].innerHTML:texty[o].value+=", "+r[t].innerHTML;let l=new ICAL.Component("vevent"),s=new ICAL.Event(l),d=texty[7].value.split("-"),u=d[0].split(":"),p=d[1].split(":");s.summary=texty[1].value,s.description=texty[4].value+", "+texty[3].value,s.uid=texty[0].value,s.startDate=ICAL.Time.now().startOfWeek(2),s.startDate.day+=n[a].offsetTop/120,s.startDate.hour=parseInt(u[0]),s.startDate.minute=parseInt(u[1]),s.startDate.wrappedJSObject.isDate=!1,s.startDate=ICAL.Time.fromString(s.startDate.toString()),s.endDate=ICAL.Time.now().startOfWeek(2),s.endDate.day+=n[a].offsetTop/120,s.endDate.hour=parseInt(p[0]),s.endDate.minute=parseInt(p[1]),s.endDate.wrappedJSObject.isDate=!1,s.endDate=ICAL.Time.fromString(s.endDate.toString()),l.addPropertyWithValue("RRULE","FREQ=WEEKLY;BYDAY="+dayFromPosition(n[a])+";INTERVAL=1"),t.addSubcomponent(l)}console.log(t.toString()),$('script[src="https://unpkg.com/ical.js@1.4.0/build/ical.js"]').remove()}$("head").append('<script async defer type="text/javascript" src="https://unpkg.com/ical.js@1.4.0/build/ical.js"><\/script>'),whenAvailable("ICAL",function(t){generateICal()});